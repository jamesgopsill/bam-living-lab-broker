<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@jamesgopsill/bam-living-lab-broker</title><meta name="description" content="Documentation for @jamesgopsill/bam-living-lab-broker"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@jamesgopsill/bam-living-lab-broker</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1> @jamesgopsill/bam-living-lab-broker </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#brokering-additive-manufacturing-living-lab" id="brokering-additive-manufacturing-living-lab" style="color: inherit; text-decoration: none;">
  <h1>Brokering Additive Manufacturing Living Lab</h1>
</a>
<p>The Brokering Additive Manufacturing (BAM) Living Lab is a demonstrator and test bed for agent-based manufacturing research.
It provides the platform that enables 3D printers and jobs to broker connections, negotiate and bid for work.
3D printers and jobs are both agents – self-aware and able to reason – enabling local rather than centralised governance and control of existing approaches.
The approach affords accessibility, inclusivity, responsiveness, and resilience.
Features that are inherently difficult or impossible for conventional approaches to attain.</p>

<a href="#contents" id="contents" style="color: inherit; text-decoration: none;">
  <h2>Contents</h2>
</a>
<ul>
<li><a href="#how-does-it-work">How does it work?</a></li>
<li><a href="#running-the-service">Running the service.</a></li>
<li><a href="#the-role-of-the-broker">The role of the broker</a></li>
</ul>

<a href="#how-does-it-work" id="how-does-it-work" style="color: inherit; text-decoration: none;">
  <h2>How does it work?</h2>
</a>
<p>The platform is built using Typescript, is entirely web-based and designed with modularity in mind. The modules include:</p>
<ul>
<li><strong>The Broker</strong>. This handles the communication between Machines and Jobs. This repository.</li>
<li><strong>Machine and Job Agents</strong>. These handles the connections and sets the logics for Machines and Jobs to interact with the platform.</li>
<li><strong>Machine Clients</strong>. That provide the connections to the different types of 3D printer. We have built clients for Ultimaker, Octoprint and a direct connection via WebUSB.<ul>
<li><a href="https://github.com/jamesgopsill/ultimaker-client">Ultimaker Client</a></li>
<li><a href="https://github.com/jamesgopsill/prusa-client">Prusa Client</a></li>
<li><a href="https://github.com/jamesgopsill/octoprint-client">Octoprint Client</a></li>
<li><a href="https://github.com/jamesgopsill/svelte-web-serial">Web Serial</a></li>
</ul>
</li>
<li><strong>Living Lab Website</strong>. That brings the agent and client modules together so individual can submit Jobs and add their printers to the service.</li>
<li><strong>Dummy Machine and Job Agents</strong>. Code that can mimic a job and machine for testing purposes and to create a Digital Twin of the service.</li>
</ul>
<p>The agent-based manufacturing systems features three types of agent - Machine, Job and Broker.
Machine agents represent the AM machines, Job agents represent the jobs that need to be manufactured, and Broker agents broker connections and communication between the Machine and Job agents.</p>
<p><img src="figs/arch.png" alt="">
<img src="https://github.com/jamesgopsill/bam-living-lab-broker/blob/main/figs/arch.png" alt=""></p>
<p><img src="figs/living-lab.png" alt="">
<img src="https://github.com/jamesgopsill/bam-living-lab-broker/blob/main/figs/living-lab.png" alt=""></p>
<p>The Broker permits direct and broadcast (to a population) communication and provides the communication protocol for the platform.
The protocol is detailed as an Typescript interface and details can be viewed in the docs.
An example is shown here:</p>
<pre><code><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-2">enum</span><span class="hl-1"> </span><span class="hl-3">MessageProtocols</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">DIRECT</span><span class="hl-1"> = </span><span class="hl-5">&quot;direct&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">ALL_MACHINES</span><span class="hl-1"> = </span><span class="hl-5">&quot;all_machines&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">ALL_JOBS</span><span class="hl-1"> = </span><span class="hl-5">&quot;all_jobs&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">MESSAGE_ERROR</span><span class="hl-1"> = </span><span class="hl-5">&quot;message_error&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">CONNECT</span><span class="hl-1"> = </span><span class="hl-5">&quot;connect&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">CONNECT_ERROR</span><span class="hl-1"> = </span><span class="hl-5">&quot;connect_error&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">STATS</span><span class="hl-1"> = </span><span class="hl-5">&quot;stats&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Within these protocols, one can set up the communications strategy between jobs and machines.
The communication strategy employed exists on a spectrum of brokerage (Figure 4).
On the one end, we have co-ordinated manufacturing where the Machine agents lead on the discussion and make the decisions as to which jobs to manufacture with the Job agents being submissive.
On the other end, we have marketplace manufacturing where the Job agents lead the discussions and make the decisions, and the Machine agents are submissive.
In the middle, exists brokered manufacturing where both Machine and Job agents negotiate and agree upon where they will be manufactured.</p>

<a href="#running-the-broker" id="running-the-broker" style="color: inherit; text-decoration: none;">
  <h2>Running the broker.</h2>
</a>
<p>To run an instance of the broker, first clone this repo onto your device.
One can either use the Command Line Interface (CLI) [In progress], Docker instance or import it into a script.</p>

<a href="#running-from-a-script" id="running-from-a-script" style="color: inherit; text-decoration: none;">
  <h3>Running from a script</h3>
</a>
<p>An example of a script that instantiates and runs the broker can be found in the <code>example</code> folder.
It can be run using the command <code>pnpm</code></p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-6">Broker</span><span class="hl-1">, </span><span class="hl-6">BrokerConfig</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-5">&quot;@jamesgopsill/bam-living-lab-server&quot;</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">config</span><span class="hl-1">: </span><span class="hl-3">BrokerConfig</span><span class="hl-1"> = {</span><br/><span class="hl-1">    </span><span class="hl-6">logFolderPath:</span><span class="hl-1"> </span><span class="hl-5">&quot;&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">accessLogsKey:</span><span class="hl-1"> </span><span class="hl-5">&quot;&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">socketKey:</span><span class="hl-1"> </span><span class="hl-5">&quot;&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">debug:</span><span class="hl-1"> </span><span class="hl-2">false</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">broker</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-7">Broker</span><span class="hl-1">(</span><span class="hl-6">config</span><span class="hl-1">)</span><br/><br/><span class="hl-6">broker</span><span class="hl-1">.</span><span class="hl-7">start</span><span class="hl-1">()</span>
</code></pre>

<a href="#running-using-docker" id="running-using-docker" style="color: inherit; text-decoration: none;">
  <h3>Running using Docker</h3>
</a>
<p>Please <code>docker-compose.sample.yml</code> for a sample docker compose file for running the broker.</p>

<a href="#contributing" id="contributing" style="color: inherit; text-decoration: none;">
  <h2>Contributing</h2>
</a>
<p>We would love to have additional contributors to the project to help us maintain and add functionality to the project.</p>

<a href="#support-the-project" id="support-the-project" style="color: inherit; text-decoration: none;">
  <h2>Support the Project</h2>
</a>
<p>The project has been supported by the <a href="https://gow.epsrc.ukri.org/NGBOViewGrant.aspx?GrantRef=EP/V05113X/1">EPSRC-funded Brokering Additive Manufacturing project (EP/V05113X/1)</a>.
More details on the project can be found at the <a href="https://dmf-lab.co.uk/">Design Manufacturing Futures Lab</a> website.</p>
<p>If you like this project, please consider sponsoring the developers so they can continue to maintain and improve the package.</p>

<a href="#publications" id="publications" style="color: inherit; text-decoration: none;">
  <h2>Publications</h2>
</a>
<ul>
<li><a href="https://link.springer.com/book/9789811933585">J. Gopsill, M. Obi, L. Giunta and M. Goudswaard. “Queueless: Agent-Based Manufacturing for Workshop Production”. Proceedings of the 16th International KES Conference on Agent &amp; Multi-Agent Systems: Technologies &amp; Applications. 2022.</a></li>
<li><a href="https://iopscience.iop.org/article/10.1088/1757-899X/1193/1/012119/meta">M. Goudswaard, J. Gopsill, A. Ma, A. Nassehi, and B. Hicks. “Responding to rapidly changing product demand through a coordinated additive manufacturing production system: a COVID-19 case study”. In: Proceedings of the Manufacturing Engineering Society International Conference. 2021.</a></li>
</ul>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>